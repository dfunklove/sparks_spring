<!DOCTYPE html>
<html lang="en" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
  layout:decorate="~{layout}">

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0" />
  <title>lessons</title>

  <link rel="stylesheet" type="text/css" th:href="@{/css/style.css}" />
</head>

<body>
  <section layout:fragment="content">
    <form th:action="@{|/lessons/${lesson.id}|}" method="post" enctype="multipart/form-data" th:object="${lesson}">
      <h2>[[|${lesson.student.firstName} ${lesson.student.lastName} . Check Out|]]</h2>
      <!--p className="time-in">Lesson started at: [[${#temporals.format(lesson.timeIn)}]]</p-->
<div className="lesson-fields" th:with="prefix=((${index} != null) ? 'student_'+${index}+'_' : '')">
    <input type="hidden" th:name="|${prefix}id|" th:value="${lesson.id}"></input>
    <span className="lesson-field student-name">
      <span className="student-first-name">{lesson.student.firstName} </span>
      <span className="student-last-name">{lesson.student.lastName}</span>
    </span>
    <label>Goals</label>
    <span className="lesson-field ratings">
    <div className="rating-list">
    { student_goals.map((sg, sg_i) => 
      <div className="rating" key={sg_i}>
        <select className="goal" name={`${prefix}rating${sg_i}_goalId`} defaultValue={sg.id} onChange={checkFormErrors}>
          <option value="">[None]</option>
          { goals.map((goal, g_i) => <option key={g_i} value={goal.id}>{goal.name}</option>) }
        </select>
        <select className="score" name={`${prefix}rating${sg_i}_score`} onChange={checkFormErrors} required={sg.id ? true : false}>
          <option value=""></option>
          { rating_scale.map((val, v_i) => <option key={v_i} value={val}>{val}</option>)}
        </select>
        <span className="error"></span>
      </div>
    )}
    </div>
    </span>
    <label>Notes</label>
    <span className="lesson-field notes">
      <textarea name={`${prefix}notes`} rows={4}></textarea>
    </span>
  </div>
      <button id="submit" type="submit">Finish Lesson</button>
    </form>
  </section>
</body>
</html>